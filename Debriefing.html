<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quiz</title>
    <script src="js/jspsych.js"></script>
    <script src="js/custom.css"></script>
    <script src="js/jspsych-survey-multi-choice.js"></script>
</head>
<script>    

var timeline = [];
var debrief = [
        {
            prompt: "I used the slider to indicate the chances of winning 1 point, if I had made the hypothetical choice that was presented. ",
            options: [
                "True",
                "False",
                "Sometimes",
            ],
            required: true,
            horizontal: false,
            correct: 1, // which answer is correct?
        },
    ]

    // Define how many questions have to be answered correctly to advance
    var nQuestions = 1  // How many questions should be sampled?
    var reminder_pages = [];  // initialize an empty list that will collect reminder pages of incorrect responses
    /* Comprehension quiz */
    var debriefquiz = {
        type: "survey-multi-choice",
        preamble: `
    <p align="justify"> 
  You have reached the end of the study. Here are a few questions. Please answer them based on your experience of the task and what you did in the task. Please be as honest as possible. The red * after a question indicates that those questions are compulsory. </p>
    </div>`,
        questions: function () {
            return debrief;
        },
        randomize_question_order: false,
        button_label: "Submit answers",
        on_start: function () {
            document.body.style.cursor = "auto";
            nCorrect = 0;
        },
        on_finish: function (data) {
            data.questions = debrief; // Save questions that were asked

            // Count correct responses
            var responses = data.response;
            var i;
            for (i = 0; i < debrief.length; i++) {
                var response = responses["Q" + i];
                var correct =
                    response ===
                    debrief[i]["options"][debrief[i]["correct"]];
                if (correct) {
                    nCorrect++;
                }
            }
            // Draw a new sample of questions
            questionSample = jsPsych.randomization.sampleWithoutReplacement(
                debrief,
                nQuestions
            );
        },
    };
    // Put the quiz procedure together
    debriefing = {
        timeline: [
            debriefquiz
        ],

    };
    
    timeline.push(debriefing)
    jsPsych.init({
        timeline: timeline,
    });
</script>
</html>

// Reference: https://github.com/moltaire/causality_task/ 
